package com.jiuqi.dna.core.info;

import com.jiuqi.dna.core.LifeHandle;
import com.jiuqi.dna.core.exception.AbortException;

/**
 * 
 * @author gaojingxin
 * 
 */
public interface ProgressReporter extends LifeHandle {
	/**
	 * 应用上一部的步长，并设置下一步的步长,<br>
	 * 必须是0f到getRestPartialProgress()之间的数，<br>
	 * 如果超过了getRestPartialProgress()，则按getRestPartialProgress()设置步长<br>
	 * 
	 * 
	 * @param step
	 *            下一步的步长
	 */
	public float setNextStep(float nextStep);

	/**
	 * 获得下一步的步长
	 */
	public float getNextStep();

	/**
	 * 应用上一部的步长，并设置下一步之后局部进度所要抵达的位置,<br>
	 * 必须是getPartialProgress()+getNextStep()到1f之间的数，<br>
	 * 如果小于getPartialProgress()+getNextStep()则进度进到getPartialProgress()+
	 * getNextStep()，<br>
	 * 如果大于1f，则进度为1f<br>
	 * 
	 * @param nextProgress
	 *            下一步后达到的局部进度
	 */
	public float setNextPartialProgress(float nextProgress);

	/**
	 * 获得当前处理剩余的进度
	 */
	public float getRestPartialProgress();

	/**
	 * 获得当前处理的进度
	 * 
	 * @return 返回当前上下文处理的进度
	 */
	public float getPartialProgress();

	/**
	 * 并设置局部进度<br>
	 * 必须是getPartialProgress()+getNextStep()到1f之间的数，<br>
	 * 如果小于getPartialProgress()+getNextStep()则进度进到getPartialProgress()+
	 * getNextStep()，<br>
	 * 如果大于1f，则进度为1f<br>
	 * 
	 * @param progress
	 *            达到的局部进度
	 */
	public float setPartialProgress(float progress);

	/**
	 * 获得全部请求的总进度
	 * 
	 * @return 返回当前请求处理的总进度
	 */
	public float getTotalProgress();

	/**
	 * 获得当前处理所占整个整个请求处理的比例。
	 * 
	 * @return 当前处理所占整个整个请求处理的比例。
	 */
	public float getPartialProgressQuotiety();

	/**
	 * 检查是否被外界取消
	 */
	public boolean isCanceling();

	/**
	 * 检查是否被取消，如果终止了则抛出InterruptedException异常
	 */
	public void throwIfCanceling();

	/**
	 * 终止当前操作，将引发事务会滚
	 */
	public void abort() throws AbortException;

}
